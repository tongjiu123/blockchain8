2025-07-15 14:36:56,591 - INFO - ====== 开始分别运行所有实验 ======
2025-07-15 14:36:56,591 - INFO - 步骤1: 生成证书数据集
2025-07-15 14:36:56,591 - INFO - 运行命令：['python', 'generate_dataset.py'] (CWD: /Users/yangzongyou/Downloads/iccip 2022/code_exp/scripts)
2025-07-15 14:37:03,797 - INFO - 命令成功完成：['python', 'generate_dataset.py']
2025-07-15 14:37:03,797 - INFO - 步骤2: 检查Hardhat节点
2025-07-15 14:37:03,800 - INFO - Hardhat节点未运行，正在启动...
2025-07-15 14:37:13,807 - INFO - Hardhat节点已成功启动
2025-07-15 14:37:13,809 - INFO - 运行 实验5: 撤销机制效率分析
2025-07-15 14:37:13,809 - INFO - 运行实验5 - 撤销机制效率分析
2025-07-15 14:37:13,810 - INFO - 运行命令：['python', 'temp_exp5.py'] (CWD: /Users/yangzongyou/Downloads/iccip 2022/code_exp/scripts)
2025-07-15 14:37:20,622 - ERROR - 命令执行失败：['python', 'temp_exp5.py']
2025-07-15 14:37:20,622 - ERROR - 错误输出：2025-07-15 14:37:14,848 - INFO - ====== 开始运行实验 5 ======
2025-07-15 14:37:14,848 - INFO - Log file: /Users/yangzongyou/Downloads/iccip 2022/code_exp/log/experiment5_20250715_143714.log
2025-07-15 14:37:19,871 - INFO - Connected to Web3. Default account: 0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
2025-07-15 14:37:19,871 - INFO - Blockchain helper initialized.
2025-07-15 14:37:19,871 - INFO - Creating contract factories...
2025-07-15 14:37:19,875 - INFO - Contract factories created.
2025-07-15 14:37:19,875 - INFO - Starting experiment function: run_experiment_5_revocation...
2025-07-15 14:37:19,875 - INFO - --- Starting Experiment 5: Revocation Mechanism ---
2025-07-15 14:37:19,875 - INFO - Deploying contracts for Exp5...
2025-07-15 14:37:19,875 - INFO - Deploying Certificate_Exp5...
2025-07-15 14:37:19,898 - INFO - Certificate_Exp5 deployed at 0x5FbDB2315678afecb367f032d93F642f64180aa3. Gas used: 620351
2025-07-15 14:37:19,898 - INFO - Authorizing deployer as an institution for 0x5FbDB2315678afecb367f032d93F642f64180aa3...
2025-07-15 14:37:19,904 - INFO - Authorization successful.
2025-07-15 14:37:19,904 - INFO - Deploying BaselineRevocation_Exp5...
2025-07-15 14:37:19,911 - INFO - BaselineRevocation_Exp5 deployed at 0x9fE46736679d2D9a65F0992F2272dE9f3c7fa6e0. Gas used: 197730
2025-07-15 14:37:19,931 - INFO - Testing revocation set size: 1
2025-07-15 14:37:19,931 - INFO - [Our Model] Issuing and revoking 1 certificates...

[Our Model] Setup for size 1:   0%|          | 0/1 [00:00<?, ?it/s]
[Our Model] Setup for size 1: 100%|██████████| 1/1 [00:00<00:00, 68.00it/s]
2025-07-15 14:37:19,959 - INFO - [Baseline Model] Revoking 1 certificates...

[Baseline Model] Setup for size 1:   0%|          | 0/1 [00:00<?, ?it/s]
[Baseline Model] Setup for size 1: 100%|██████████| 1/1 [00:00<00:00, 163.37it/s]
2025-07-15 14:37:19,965 - INFO - Measuring verification performance for size 1 (100 queries)...

Verification Measurement:   0%|          | 0/100 [00:00<?, ?it/s]
Verification Measurement:  18%|█▊        | 18/100 [00:00<00:00, 174.91it/s]
Verification Measurement:  37%|███▋      | 37/100 [00:00<00:00, 179.82it/s]
Verification Measurement:  56%|█████▌    | 56/100 [00:00<00:00, 181.88it/s]
Verification Measurement:  75%|███████▌  | 75/100 [00:00<00:00, 183.83it/s]
Verification Measurement:  95%|█████████▌| 95/100 [00:00<00:00, 185.96it/s]
Verification Measurement: 100%|██████████| 100/100 [00:00<00:00, 184.15it/s]
2025-07-15 14:37:20,516 - INFO - Size 1: Verification stats collected.
2025-07-15 14:37:20,516 - INFO - Testing revocation set size: 10
2025-07-15 14:37:20,516 - INFO - [Our Model] Issuing and revoking 10 certificates...

[Our Model] Setup for size 10:   0%|          | 0/10 [00:00<?, ?it/s]
[Our Model] Setup for size 10:   0%|          | 0/10 [00:00<?, ?it/s]
2025-07-15 14:37:20,527 - ERROR - 实验 5 运行失败: execution reverted: Error: VM Exception while processing transaction: reverted with reason string 'Certificate already exists'
Traceback (most recent call last):
  File "/Users/yangzongyou/Downloads/iccip 2022/code_exp/scripts/temp_exp5.py", line 63, in <module>
    main_logic()
  File "/Users/yangzongyou/Downloads/iccip 2022/code_exp/scripts/temp_exp5.py", line 54, in main_logic
    run_experiment_5_revocation(helper, cert_factory, baseline_revocation_factory)
  File "/Users/yangzongyou/Downloads/iccip 2022/code_exp/scripts/simulation.py", line 296, in run_experiment_5_revocation
    tx_hash_issue = cert_contract.functions.issueCertificate(certificate_hashes[i]).transact()
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/cmbi/lib/python3.11/site-packages/web3/contract/contract.py", line 323, in transact
    return transact_with_contract_function(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/cmbi/lib/python3.11/site-packages/web3/contract/utils.py", line 172, in transact_with_contract_function
    txn_hash = w3.eth.send_transaction(transact_transaction)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/cmbi/lib/python3.11/site-packages/web3/eth/eth.py", line 380, in send_transaction
    return self._send_transaction(transaction)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/cmbi/lib/python3.11/site-packages/web3/module.py", line 75, in caller
    result = w3.manager.request_blocking(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/cmbi/lib/python3.11/site-packages/web3/manager.py", line 324, in request_blocking
    response = self._make_request(method, params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/cmbi/lib/python3.11/site-packages/web3/manager.py", line 212, in _make_request
    return request_func(method, params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/cmbi/lib/python3.11/site-packages/web3/middleware/gas_price_strategy.py", line 100, in middleware
    return make_request(method, (transaction,))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/cmbi/lib/python3.11/site-packages/web3/middleware/formatting.py", line 126, in middleware
    response = make_request(method, params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/cmbi/lib/python3.11/site-packages/web3/middleware/attrdict.py", line 43, in middleware
    response = make_request(method, params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/cmbi/lib/python3.11/site-packages/web3/middleware/formatting.py", line 126, in middleware
    response = make_request(method, params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/cmbi/lib/python3.11/site-packages/web3/middleware/formatting.py", line 126, in middleware
    response = make_request(method, params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/cmbi/lib/python3.11/site-packages/web3/middleware/buffered_gas_estimate.py", line 40, in middleware
    hex(get_buffered_gas_estimate(w3, transaction)),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/cmbi/lib/python3.11/site-packages/web3/_utils/transactions.py", line 154, in get_buffered_gas_estimate
    gas_estimate = w3.eth.estimate_gas(gas_estimate_transaction)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/cmbi/lib/python3.11/site-packages/web3/eth/eth.py", line 310, in estimate_gas
    return self._estimate_gas(transaction, block_identifier)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/cmbi/lib/python3.11/site-packages/web3/module.py", line 75, in caller
    result = w3.manager.request_blocking(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/cmbi/lib/python3.11/site-packages/web3/manager.py", line 325, in request_blocking
    return self.formatted_response(
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/envs/cmbi/lib/python3.11/site-packages/web3/manager.py", line 286, in formatted_response
    apply_error_formatters(error_formatters, response)
  File "/opt/anaconda3/envs/cmbi/lib/python3.11/site-packages/web3/manager.py", line 103, in apply_error_formatters
    formatted_resp = pipe(response, error_formatters)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "cytoolz/functoolz.pyx", line 685, in cytoolz.functoolz.pipe
  File "cytoolz/functoolz.pyx", line 660, in cytoolz.functoolz.c_pipe
  File "/opt/anaconda3/envs/cmbi/lib/python3.11/site-packages/web3/_utils/contract_error_handling.py", line 154, in raise_contract_logic_error_on_revert
    raise ContractLogicError(f"execution reverted: {message}", data=data)
web3.exceptions.ContractLogicError: execution reverted: Error: VM Exception while processing transaction: reverted with reason string 'Certificate already exists'

2025-07-15 14:37:20,622 - ERROR - 实验5: 撤销机制效率分析 运行失败，继续下一个实验
2025-07-15 14:37:25,628 - INFO - 运行 实验6: 节点故障恢复测试
2025-07-15 14:37:25,628 - INFO - 运行实验6 - 节点故障恢复测试
2025-07-15 14:37:25,628 - INFO - 运行命令：['python', '/Users/yangzongyou/Downloads/iccip 2022/code_exp/scripts/run_fault_test.py'] (CWD: /Users/yangzongyou/Downloads/iccip 2022/code_exp)
2025-07-15 14:45:18,074 - INFO - 命令成功完成：['python', '/Users/yangzongyou/Downloads/iccip 2022/code_exp/scripts/run_fault_test.py']
2025-07-15 14:45:18,074 - INFO - 实验6: 节点故障恢复测试 运行成功
2025-07-15 14:45:18,074 - INFO - 分析所有实验结果
2025-07-15 14:45:18,074 - INFO - 分析所有实验结果
2025-07-15 14:45:18,074 - INFO - 运行命令：['python', 'analyze_results.py'] (CWD: /Users/yangzongyou/Downloads/iccip 2022/code_exp/scripts)
2025-07-15 14:45:21,860 - INFO - 命令成功完成：['python', 'analyze_results.py']
2025-07-15 14:45:21,860 - INFO - 运行命令：['python', 'analyze_fault_tolerance.py'] (CWD: /Users/yangzongyou/Downloads/iccip 2022/code_exp/scripts)
2025-07-15 14:45:22,980 - INFO - 命令成功完成：['python', 'analyze_fault_tolerance.py']
2025-07-15 14:45:22,980 - INFO - 实验结果分析成功
2025-07-15 14:45:22,980 - INFO - Hardhat节点已关闭
2025-07-15 14:45:22,980 - INFO - ====== 所有实验运行完成 ======
2025-07-15 14:45:22,980 - INFO - 请查看 data/ 目录和 analysis/ 目录获取实验结果和分析
